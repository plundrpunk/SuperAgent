# Documentation Summary: Agent Details

This document provides a summary of the specialized agents within the SuperAgent system, based on their individual documentation.

---

## 1. Scribe (The Test Writer)

**Primary Role**: To generate production-ready Playwright tests from natural language descriptions.

### Key Features:
- **Model Selection**: Uses a complexity-based model selection. Simple tests (e.g., basic navigation) use the cheaper and faster **Claude Haiku**, while complex tests (e.g., authentication, payments) use the more powerful **Claude Sonnet 4.5**.
- **RAG (Retrieval-Augmented Generation)**: Before generating a test, Scribe queries a vector database for similar, previously successful test patterns. This improves the consistency and quality of the generated code by learning from what has worked in the past.
- **Self-Validation & Auto-Retry**: This is a critical feature. After generating a test, Scribe immediately validates it against a strict set of criteria (the same ones used by the Critic agent). If validation fails, it automatically retries up to 3 times, enhancing the prompt with specific feedback on what to fix. This significantly reduces the number of low-quality tests that proceed to more expensive validation stages.

### Validation Criteria (Enforced by Scribe):
- **Must Use**: `data-testid` selectors, at least one `expect()` assertion, and screenshots.
- **Must NOT Use (Anti-Patterns)**: Flaky selectors like `.nth()` or generated `.css-*` classes, `waitForTimeout`, hard-coded credentials, or `localhost` URLs.

---

## 2. Critic (The Pre-Validator)

**Primary Role**: To act as a fast, cheap, and automated quality gate for tests generated by Scribe.

### Key Features:
- **Static Analysis**: The Critic does not run the test. It performs static analysis on the code to check for a list of well-defined anti-patterns and quality requirements.
- **Detailed Feedback**: When a test is rejected, the Critic provides structured, actionable feedback, including the exact line number, the problematic code, the reason for the rejection, and a specific suggestion for a fix. This feedback is crucial for the Scribe's auto-retry loop.
- **Severity Levels**: Issues are categorized as `Critical` (e.g., using a flaky selector) or `Warning` (e.g., the test has too many steps).

### Scribe & Critic Alignment:
- The self-validation criteria used by Scribe are identical to the rejection criteria used by the Critic. This alignment is key to the workflow, as it ensures Scribe is producing tests that will pass the Critic's quality check, making the Critic's role more of a final verification step.

---

## 3. Gemini (The Final Validator)

**Primary Role**: To provide the ultimate proof of a test's correctness by executing it in a real browser environment.

### Key Features:
- **Browser Execution**: The Gemini agent uses Playwright to launch a real browser (headed or headless) and run the test against the live application.
- **Visual Evidence**: It captures screenshots at key steps during the test execution, providing a visual audit trail.
- **Strict Validation Rubric**: A test is only considered successful if it meets a strict set of criteria, including: the browser launched, the test executed and passed, at least one screenshot was captured, and the execution time was under 45 seconds.
- **AI-Powered Analysis (Optional)**: For critical tests, an optional second phase can be enabled where the captured screenshots are sent to the **Gemini 2.5 Pro** vision model for AI-powered analysis of UI correctness and visual regressions. This feature is disabled by default for cost-control.

---

## 4. Medic (The Bug Fixer)

**Primary Role**: To diagnose and automatically fix failing tests.

### Key Features:
- **Hippocratic Oath ("Do No Harm")**: The Medic's core principle. It is strictly forbidden from introducing new failures. It achieves this by running a baseline set of regression tests *before* and *after* applying a fix. If any new tests fail after the fix, the change is automatically rolled back.
- **Minimal Surgical Fixes**: The agent is designed to make the smallest possible change to resolve an error, preferring to update a selector rather than refactor logic.
- **Artifact Generation**: For every fix attempt, the Medic produces a `fix.diff` file showing the exact code change and a `regression_report.json` with the before-and-after test results.
- **Escalation**: If the Medic fails to fix an issue after multiple attempts or if it violates the Hippocratic Oath, the task is automatically escalated to the Human-in-the-Loop (HITL) queue for manual review.
